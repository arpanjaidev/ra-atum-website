<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Wallet – RA Atum</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <style>
    body {
      background: #0e1018;
      color: #fff;
      font-family: 'Share Tech Mono', monospace;
      margin: 0;
      min-height: 100vh;
      padding: 0;
    }
    .wallet-main-flex {
      display: flex;
      align-items: flex-start;
      justify-content: center;
      gap: 50px;
      padding: 48px 0 0 0;
      max-width: 980px;
      margin: 0 auto;
    }
    .ra-logo-big {
      width: 178px;
      height: 178px;
      max-width: 35vw;
      border-radius: 35px;
      object-fit: contain;
      background: #191b2a;
      box-shadow: 0 8px 48px #00b4fa88, 0 0 0 7px #191a2477;
      border: 3px solid #00b4fa44;
      margin-top: 16px;
      margin-left: 8px;
      display: block;
      transition: transform .22s;
    }
    .ra-logo-big:hover {
      transform: scale(1.04) rotate(-2deg);
      box-shadow: 0 18px 68px #00b4faaa, 0 0 0 12px #191a24bb;
    }
    .wallet-container {
      background: #181a1b;
      border-radius: 22px;
      box-shadow: 0 8px 32px #00b4fa33;
      width: 330px;
      min-width: 250px;
      margin: 20px 0 0 0;
      padding: 32px 24px 24px 24px;
      border: 2.5px solid #00b4fa;
      position: relative;
      z-index: 2;
      font-family: 'Share Tech Mono', monospace;
      display: flex;
      flex-direction: column;
      align-items: flex-end;
    }
    .wallet-title {
      font-size: 1.5rem;
      letter-spacing: 1.5px;
      font-weight: bold;
      margin-bottom: 23px;
      align-self: flex-end;
      /* Shine effect like AUDITS */
      background: linear-gradient(90deg, #fff 8%, #00b4fa 60%, #23e6ff 98%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 2px 18px #22213866, 0 0 8px #00b4fa88, 0 0 18px #00b4fa99;
      filter: brightness(1.16) drop-shadow(0 0 3px #00e6ff99);
      text-transform: uppercase;
    }
    .wallet-info-row {
      display: flex;
      justify-content: space-between;
      width: 100%;
      margin: 16px 0;
      font-size: 1.08rem;
      font-weight: bold;
      color: #e7d7b6;
      border-bottom: 1px solid #202f38;
      padding-bottom: 6px;
    }
    .wallet-info-row:last-child { border-bottom: none; }
    .wallet-address {
      margin: 13px 0 19px 0;
      font-size: 1rem;
      color: #00b4fa;
      word-break: break-all;
      letter-spacing: 0.6px;
      min-height: 20px;
      background: #23243b;
      border-radius: 7px;
      padding: 7px 10px;
      font-weight: bold;
      display: inline-block;
      box-shadow: 0 2px 16px #00b4fa33;
      border: 1.5px solid #00b4fa44;
      align-self: flex-end;
      font-family: 'Share Tech Mono', monospace;
    }
    .wallet-connect-btn {
      background: linear-gradient(90deg, #00b4fa 0%, #00ffd0 100%);
      color: #181a1b;
      border: none;
      border-radius: 12px;
      padding: 12px 30px;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 2px 18px #00b4fa33;
      transition: background .17s, color .17s;
      letter-spacing: 1px;
      font-family: 'Share Tech Mono', monospace;
      opacity: 0.97;
      margin-top: 13px;
      margin-bottom: 18px;
      align-self: flex-end;
    }
    .wallet-connect-btn:hover { background: #e7d7b6; color: #002a37; }
    .wallet-msg { margin: 8px 0 0 0; min-height: 22px; font-size: 1rem; align-self: flex-end;}
    .wallet-buy-btn {
      margin-top: 22px;
      background: linear-gradient(92deg, #00b4fa 10%, #00ffd0 75%, #23e6ff 100%);
      color: #181a1b;
      border: none;
      border-radius: 13px;
      padding: 13px 0;
      width: 90%;
      font-size: 1.12rem;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 6px 32px #00b4fa44, 0 1.5px 16px #00ffd044;
      transition: background .18s, color .13s, transform .13s;
      letter-spacing: 1.15px;
      font-family: 'Share Tech Mono', monospace;
      opacity: 1;
      text-shadow: 0 2px 15px #00b4fa22;
      outline: none;
      display: block;
      align-self: flex-end;
      text-align: center;
    }
    .wallet-buy-btn:hover { background: #00ffd0; color: #222; transform: scale(1.022);}
    a.back-link { color:#00b4fa; margin-top: 15px; display:inline-block; font-size:1.02em; align-self: flex-end;}
    a.back-link:hover { text-decoration: underline;}

    @media (max-width: 850px) {
      .wallet-main-flex { flex-direction: column; align-items: center; gap: 22px; }
      .ra-logo-big { margin: 0 auto 14px auto; }
      .wallet-container { align-items: center; width: 98vw; max-width: 370px; }
      .wallet-title, .wallet-msg, .wallet-buy-btn, .wallet-connect-btn, .wallet-address, .wallet-info-row, a.back-link { align-self: center !important; }
    }
    @media (max-width: 480px) {
      .wallet-container { padding: 18px 5vw 18px 5vw; }
      .wallet-title { font-size: 1.14rem; }
      .ra-logo-big { width: 106px; height: 106px;}
    }
  </style>
</head>
<body>
  <div class="wallet-main-flex">
    <img src="RA-ATUM-LOGO.png" alt="RA Atum Logo" class="ra-logo-big" />
    <div class="wallet-container">
      <div class="wallet-title"><i class="fas fa-wallet"></i> Wallet Overview</div>
      <div id="wallet-address" class="wallet-address">Not connected</div>
      <div class="wallet-info-row">
        <span>Token Balance</span>
        <span id="token-balance">–</span>
      </div>
      <div class="wallet-info-row">
        <span>Referral Earnings</span>
        <span id="referral-earnings">–</span>
      </div>
      <button class="wallet-connect-btn" id="connect-wallet-btn"><i class="fa-solid fa-link"></i> Connect Wallet</button>
      <button class="wallet-buy-btn" onclick="window.location.href='index.html#buy-section'"><i class="fas fa-bolt"></i> Buy RA Atum</button>
      <div class="wallet-msg" id="wallet-msg"></div>
      <a href="index.html" class="back-link"><i class="fas fa-arrow-left"></i> Back to Home</a>
    </div>
  </div>

  <div style="text-align:center;margin-top:38px;">
    <span id="wallet-typing-shine"
      style="font-size:1.18em;display:inline-block;min-height:1.7em;
        font-family:'Share Tech Mono', monospace;font-weight:bold;
        text-transform:uppercase;
        background:linear-gradient(90deg,#fff 8%,#00b4fa 60%,#23e6ff 98%);
        -webkit-background-clip:text;-webkit-text-fill-color:transparent;
        background-clip:text;
        text-shadow:0 2px 18px #22213866,0 0 8px #00b4fa88,0 0 18px #00b4fa99;
        filter:brightness(1.15) drop-shadow(0 0 3px #00e6ff99);
        letter-spacing:1.1px;text-align:center;">
    </span>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script>
    // Typing effect headline
    const walletTypingText = "Join RA Atum to shape the future of blockchain-powered kindness.";
    const walletTypingElem = document.getElementById("wallet-typing-shine");
    let wIndex = 0;
    let wTypingForward = true;
    let wBlinkOn = true;

    function typeWalletLine() {
      if (!walletTypingElem) return;
      if (wTypingForward) {
        if (wIndex <= walletTypingText.length) {
          walletTypingElem.innerHTML = walletTypingText.substring(0, wIndex) + '<span style="color:#00b4fa;font-weight:bold;font-size:1.18em;">' + (wBlinkOn ? "|" : "&nbsp;") + '</span>';
          wIndex++;
          setTimeout(typeWalletLine, 37);
        } else {
          wTypingForward = false;
          setTimeout(typeWalletLine, 1300);
        }
      } else {
        if (wIndex >= 0) {
          walletTypingElem.innerHTML = walletTypingText.substring(0, wIndex) + '<span style="color:#00b4fa;font-weight:bold;font-size:1.18em;">' + (wBlinkOn ? "|" : "&nbsp;") + '</span>';
          wIndex--;
          setTimeout(typeWalletLine, 17);
        } else {
          wTypingForward = true;
          setTimeout(typeWalletLine, 850);
        }
      }
    }
    setInterval(function() { wBlinkOn = !wBlinkOn; }, 410);
    typeWalletLine();

    // Wallet connect logic
    const tokenAddress = "0xcE06aDbB070c2f0d90Ba109E77c0c2Ff83F9Ff3A";
    const erc20ABI = [
      "function balanceOf(address owner) view returns (uint256)",
      "function decimals() view returns (uint8)"
    ];

    document.getElementById('connect-wallet-btn').onclick = async function() {
      const walletMsg = document.getElementById('wallet-msg');
      walletMsg.innerText = "Connecting...";
      if (window.ethereum && /MetaMask/i.test(window.ethereum.isMetaMask ? 'MetaMask' : navigator.userAgent)) {
        try {
          const provider = new ethers.providers.Web3Provider(window.ethereum, "any");
          await provider.send("eth_requestAccounts", []);
          const signer = provider.getSigner();
          const address = await signer.getAddress();
          document.getElementById('wallet-address').innerText = "Address: " + address.slice(0,7) + "..." + address.slice(-4);
          walletMsg.innerText = "✅ Wallet connected!";

          // Fetch and display actual token balance
          const tokenContract = new ethers.Contract(tokenAddress, erc20ABI, provider);
          const [rawBalance, decimals] = await Promise.all([
            tokenContract.balanceOf(address),
            tokenContract.decimals()
          ]);
          const balance = ethers.utils.formatUnits(rawBalance, decimals);
          document.getElementById('token-balance').innerText = balance;

          // Dummy value for referral earnings (customize as needed)
          document.getElementById('referral-earnings').innerText = "0.00";
        } catch (err) {
          walletMsg.innerText = "❌ Wallet connection failed.";
          document.getElementById('wallet-address').innerText = "Not connected";
          document.getElementById('token-balance').innerText = "–";
          document.getElementById('referral-earnings').innerText = "–";
        }
      } else {
        walletMsg.innerText = "";
        window.location.href = "https://metamask.app.link/dapp/ra-wallet-dapp.vercel.app";
      }
    };
  </script>
</body>
</html>
